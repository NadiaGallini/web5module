// server.js
const http = require('http');
const { fetchDataAndSaveToFile } = require('./getDataAndSaveToFile'); // Импортируем функцию из предыдущего файла

const server = http.createServer((req, res) => {
    // Произвольный маршрут, например /fetchData
    if (req.url === '/fetchData') {
        const apiUrl = 'https://jsonplaceholder.typicode.com/posts';
        const fileName = 'posts_from_server.json';

        fetchDataAndSaveToFile(apiUrl, fileName); // Вызываем функцию для получения данных и сохранения в файл

        res.writeHead(200, { 'Content-Type': 'text/plain' });
        res.end(`Данные из ${apiUrl} будут сохранены в файл ${fileName}`);
    } else {
        res.writeHead(404, { 'Content-Type': 'text/plain' });
        res.end('Маршрут не найден');
    }
});

const PORT = 3000;
server.listen(PORT, () => {
    console.log(`Сервер запущен на http://localhost:${PORT}`);
});
